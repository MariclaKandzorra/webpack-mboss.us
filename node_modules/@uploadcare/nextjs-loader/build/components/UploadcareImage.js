"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.UploadcareImage = void 0;
const image_1 = __importDefault(require("next/image"));
const react_1 = __importDefault(require("react"));
const constants_1 = require("../utils/constants");
const helpers_1 = require("../utils/helpers");
const loader_1 = require("../utils/loader");
const shouldOverrideBlurDataUrl = (props) => {
    return (typeof props.src === 'string' &&
        props.placeholder === 'blur' &&
        !props.blurDataURL);
};
const generateBlurDataUrl = (src, width) => {
    const imageWidth = (0, helpers_1.getInt)(width);
    const blurImageWidth = imageWidth
        ? Math.ceil(imageWidth * constants_1.PLACEHOLDER_SIZE_MULTIPLIER)
        : constants_1.PLACEHOLDER_SIZE_FALLBACK;
    return (0, loader_1.uploadcareLoader)({
        src: src,
        width: blurImageWidth,
        quality: 1
    });
};
function UploadcareImage(props) {
    let blurDataURL = props.blurDataURL;
    if (shouldOverrideBlurDataUrl(props)) {
        blurDataURL = generateBlurDataUrl(props.src, props.width);
    }
    return (react_1.default.createElement(image_1.default, Object.assign({ loader: loader_1.uploadcareLoader, blurDataURL: blurDataURL }, props)));
}
exports.UploadcareImage = UploadcareImage;
